module.exports = async ({ 
    print,
    generate, 
    packageManager, 
    options, 
    name = 'herbs-project', 
    description = 'project generated by herbs CLI S2', 
    author = 'herbs CLI', 
    license = 'MIT' 
}) => async () => { 
    await generate({
        template: 'package.json.ejs',
        target: `package.json`,
        props: {
            name, description, author, license
        }
    })
    const packages = [
        'buchu',
        'gotu',
        'herbs2gql',
        'deepmerge',
        'graphql',
        'apollo-server-express',
        'apollo-server',
        'sugar-env',
        'dotenv',
        'herbsshelf',
        'graphql-tools']

    if(options.mongo) 
        packages.push('mongodb')
    if(options.postgres)
        packages.push('herbs2knex')
    
    let opt = { force: 'npm'}
    if(options.yarn) {
        if(packageManager.hasYarn())
            opt = { force: 'yarn'}
        else {
            print.warn('You don\'t have yarn installed')
        }
    }
    await packageManager.add(packages, opt)
}

